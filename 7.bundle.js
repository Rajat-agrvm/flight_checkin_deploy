(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{114:function(e,a,t){"use strict";t.r(a);var n=t(19),s=t(36),r=t(18),l=t(85),i=t(86),u=t(88),c=t(87),d=t(89),o=t(0),p=t.n(o),h=t(17),f=t(76),m=t(97),g=t(95),v=function(e,a,t,n){return p.a.createElement(m.a,{id:"purchase-button",variant:"secondary",title:"Update",size:"sm"},(s=a,Object.keys(s).map((function(e){return s[e]}))).map((function(a){return a&&a.value&&p.a.createElement(g.a.Item,{key:a.id,onSelect:function(){return t(e.id,a.id,n)}},a.value)})));var s},b=function(e){var a=e.passengers,t=e.flightName,n=e.inFlight,s=void 0!==n&&n,r=e.onSelect,l=e.onSave,i=e.ancillaries,u=void 0===i?{id:null}:i,c=e.specialMeals,d=void 0===c?{}:c,o=e.purchases,m=void 0===o?{}:o,g=e.saving,b=void 0!==g&&g;return p.a.createElement(p.a.Fragment,null,p.a.createElement("table",{className:"table"},p.a.createElement("thead",null,p.a.createElement("tr",null,p.a.createElement("th",null,"PNR"),p.a.createElement("th",null,"Name"),p.a.createElement("th",null,"Ancillary Service"),p.a.createElement("th",null,"Seat No."),s?p.a.createElement("th",null,"Meal Preference"):p.a.createElement("th",null,"WheelChair"),s?p.a.createElement("th",null,"In-Flight purchase"):p.a.createElement("th",null,"Infants"),s&&p.a.createElement("th",null,"Special Meals"),s&&p.a.createElement("th",null))),p.a.createElement("tbody",null,a.map((function(e){var a=e.ancillary.length>0&&u.id&&e.ancillary.filter((function(e){return u.value[e]})).length>0,n=e.specialMeals.length>0&&e.specialMeals.filter((function(e){return d[e]})).length>0,i=e.purchase.length>0&&e.purchase.filter((function(e){return m[e]})).length>0;return p.a.createElement("tr",{key:e.id},p.a.createElement("td",null,s?e.pnr:p.a.createElement(h.b,{to:"/staff/passenger/"+t+"/"+e.pnr},e.pnr)),p.a.createElement("td",null,e.name),p.a.createElement("td",null,a?e.ancillary.map((function(e){return u.value[e]&&p.a.createElement("div",{key:e},u.value[e].value)})):"NIL",s&&v(e,u.value,r,"ancillary")),p.a.createElement("td",null,e.seat?e.seat:"--",!s&&p.a.createElement(h.b,{className:"btn btn-primary btn-sm",style:{marginLeft:10},to:"/staff/passenger/"+t+"/"+e.pnr},e.seat?"update":"CheckIn")),!s&&p.a.createElement("td",null,e.wheelChair&&!0===e.wheelChair?"YES":"NO"),!s&&p.a.createElement("td",null,e.infants),s&&p.a.createElement("td",null,e.mealPreference?f.mealPreferences[e.mealPreference].value:"No Meal",v(e,f.mealPreferences,r,"mealPreference")),s&&p.a.createElement("td",null,i?e.purchase.map((function(e){return m[e]&&p.a.createElement("div",{key:e},m[e].value)})):"NIL",v(e,m,r,"purchase")),s&&p.a.createElement("td",null,n?e.specialMeals.map((function(e){return d[e]&&p.a.createElement("div",{key:e},d[e].value)})):"NIL",v(e,d,r,"specialMeals")),s&&p.a.createElement("td",null,p.a.createElement("button",{id:e.id,className:"btn btn-primary btn-sm",onClick:l},b?"saving..":"save")))})))),s&&p.a.createElement("p",{className:"information"},"**Select from the options to add or remove the item"))},I=t(34),y=t(15),E=t(77),w=t(80),S=t(90),B=t(78);t.d(a,"getFlightByName",(function(){return P}));var A=function(e){function a(){var e,t;Object(l.a)(this,a);for(var i=arguments.length,d=new Array(i),o=0;o<i;o++)d[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(c.a)(a)).call.apply(e,[this].concat(d)))).state={passengers:[],saving:!1},t.handleFilter=function(e){"Infants"===e?t.setState({passengers:t.props.passengers.filter((function(e){return e.infants>0}))}):"WheelChair"===e?t.setState({passengers:t.props.passengers.filter((function(e){return e.wheelChair}))}):"CheckedIn"===e?t.setState({passengers:t.props.passengers.filter((function(e){return e.seat&&"available"!==e.status}))}):t.setState({passengers:t.props.passengers})},t.handleSelect=function(e,a,l){t.setState((function(t){return{passengers:t.passengers.map((function(t){return t.id===e?"mealPreference"===l?Object(r.a)({},t,Object(s.a)({},l,a)):0===t[l].filter((function(e){return e===a})).length?Object(r.a)({},t,Object(s.a)({},l,[].concat(Object(n.a)(t[l]),[a]))):Object(r.a)({},t,Object(s.a)({},l,t[l].filter((function(e){return e!==a})))):t}))}}))},t.handleSave=function(e){e.preventDefault(),t.setState({saving:!0});var a=e.target.id,n=t.state.passengers.find((function(e){return e.id===parseInt(a,10)}));t.props.savePassenger(n).then((function(){return t.setState({saving:!1})})).catch((function(e){t.setState({saving:!1}),console.log("failed to save passenger details"+e)}))},t}return Object(d.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){console.log("component did mount"+JSON.stringify(this.props.passengers));var e=this.props,a=e.loadFlights,t=e.flights,n=e.passengers,s=e.loadPassengers,r=e.flightAncillaries,l=e.loadAncillaries;0===t.length&&a().catch((function(e){return alert("Loading flights failed "+e)})),r.id||l().catch((function(e){return alert("Loading ancillaries failed "+e)})),0===n.length?s().catch((function(e){return alert("Loading passengers failed "+e)})):this.setState({passengers:n})}},{key:"componentDidUpdate",value:function(e){this.props.passengers!==e.passengers&&(console.log("passengerpage:componentDidUpdate"),this.setState({passengers:this.props.passengers}))}},{key:"render",value:function(){var e=this;return p.a.createElement(p.a.Fragment,null,p.a.createElement("h2",null,"Passengers"),0!==this.props.flights.length&&this.props.passengers?p.a.createElement(p.a.Fragment,null,p.a.createElement("div",null,p.a.createElement(h.b,{style:{marginBottom:20},to:this.props.inFlight?"/staff/in-flight/"+this.props.name:"/staff/flights",className:"btn btn-primary"},"Back"),p.a.createElement(m.a,{style:{float:"right"},id:"filter-button",variant:"info",title:"Filter"},p.a.createElement(g.a.Item,{onSelect:function(){return e.handleFilter("CheckedIn")}},"CheckedIn"),p.a.createElement(g.a.Item,{onSelect:function(){return e.handleFilter("WheelChair")}},"WheelChair"),p.a.createElement(g.a.Item,{onSelect:function(){return e.handleFilter("Infants")}},"Infants"),p.a.createElement(g.a.Item,{onSelect:function(){return e.handleFilter("")}},"Clear filters..."))),p.a.createElement(b,{passengers:this.state.passengers,flightName:this.props.name,inFlight:this.props.inFlight,onSelect:this.handleSelect,onSave:this.handleSave,ancillaries:this.props.flightAncillaries,purchases:this.props.flight.purchases,specialMeals:this.props.flight.specialMeals,saving:this.state.saving})):p.a.createElement(B.a,null))}}]),a}(p.a.Component);function P(e,a){return e.find((function(e){return e.name===a}))||null}a.default=Object(I.b)((function(e,a){var t=a.match.params.name,n="/staff/in-flight/passengers/:name"===a.match.path,s=t&&e.flights.length>0?P(e.flights,t):f.newFlight,r=s&&e.passengers.length>0?e.passengers.filter((function(e){return e.flightId===s.id})):[],l=e.ancillaries.length>0&&s.id?e.ancillaries.find((function(e){return e.id===s.ancillariesId})):f.newAncillaries;return{name:t,flight:s,inFlight:n,flightAncillaries:l,flights:e.flights,passengers:r}}),(function(e){return{loadFlights:Object(y.b)(E.a,e),loadPassengers:Object(y.b)(w.a,e),savePassenger:Object(y.b)(w.b,e),loadAncillaries:Object(y.b)(S.a,e)}}))(A)},75:function(e,a,t){"use strict";t.d(a,"b",(function(){return l})),t.d(a,"a",(function(){return u}));var n=t(81),s=t.n(n),r=t(82);function l(e){return i.apply(this,arguments)}function i(){return(i=Object(r.a)(s.a.mark((function e(a){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.ok){e.next=2;break}return e.abrupt("return",a.json());case 2:if(400!==a.status){e.next=7;break}return e.next=5,a.text();case 5:throw t=e.sent,new Error(t);case 7:throw new Error("Network response was not ok.");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){throw console.error("API call failed. "+e),e}},76:function(e,a){e.exports={mealPreferences:{1:{id:1,value:"VEG"},2:{id:2,value:"NON-VEG"},3:{id:3,value:"NO MEAL"}},newPassenger:{id:null,name:"",pnr:"",flightId:null,ancillary:[],wheelChair:null,infants:0,seat:"",status:"available",mealPreference:null,specialMeals:[],purchase:[],passport:null,address:"",dob:""},newAncillaries:{id:null,value:[]},flights:[{id:1,name:"E301",departure:"13:00",destination:"Hyderabad",passengers:3,ancillariesId:1,purchases:{1:{id:1,value:"fitbit"},2:{id:2,value:"Smartwatch"},3:{id:3,value:"Bluetooth speaker"},4:{id:4,value:"EarPods"}},specialMeals:{1:{id:1,value:"Veg Sandwich"},2:{id:2,value:"Beverages"},3:{id:3,value:"Biriyani"},4:{id:4,value:"Fried Rice"}}},{id:2,name:"E302",departure:"14:00",destination:"Delhi",passengers:2,ancillariesId:2,purchases:{1:{id:1,value:"fitbit"},2:{id:2,value:"Smartwatch"},3:{id:3,value:"Bluetooth speaker"},4:{id:4,value:"EarPods"}},specialMeals:{1:{id:1,value:"Veg Sandwich"},2:{id:2,value:"Beverages"},3:{id:3,value:"Biriyani"},4:{id:4,value:"Fried Rice"}}},{id:3,name:"E303",departure:"15:00",destination:"Mumbai",passengers:3,ancillariesId:3,purchases:{1:{id:1,value:"fitbit"},2:{id:2,value:"Smartwatch"},3:{id:3,value:"Bluetooth speaker"},4:{id:4,value:"EarPods"}},specialMeals:{1:{id:1,value:"Veg Sandwich"},2:{id:2,value:"Beverages"},3:{id:3,value:"Biriyani"},4:{id:4,value:"Fried Rice"}}},{id:4,name:"E304",departure:"12:00",destination:"Jaipur",passengers:0,ancillariesId:4,purchases:{1:{id:1,value:"fitbit"},2:{id:2,value:"Smartwatch"},3:{id:3,value:"Bluetooth speaker"},4:{id:4,value:"EarPods"}},specialMeals:{1:{id:1,value:"Veg Sandwich"},2:{id:2,value:"Beverages"},3:{id:3,value:"Biriyani"},4:{id:4,value:"Fried Rice"}}}],passengers:[{id:1,name:"Scott Allen",pnr:"IND101",flightId:1,ancillary:[],wheelChair:!1,infants:0,seat:"",status:"available",mealPreference:1,purchase:[1],specialMeals:[],passport:!0,address:"xyz",dob:"1995-12-10"},{id:2,name:"Corey Hose",pnr:"IND102",flightId:1,ancillary:[4],wheelChair:!1,infants:0,seat:"1B",status:"reserved",mealPreference:2,purchase:[2],specialMeals:[1],passport:!0,address:"xyd",dob:"1994-12-10"},{id:3,name:"James",pnr:"IND103",flightId:1,ancillary:[],wheelChair:!0,infants:0,seat:"2A",status:"wheelChair",mealPreference:1,purchase:[],specialMeals:[1,2],passport:!1,address:"xyq",dob:"1995-12-11"},{id:4,name:"Bond",pnr:"IND104",flightId:2,ancillary:[1],wheelChair:!1,infants:1,seat:"2A",status:"infants",mealPreference:3,purchase:[],specialMeals:[3],passport:!0,address:"",dob:"1994-12-10"},{id:5,name:"Kevin",pnr:"IND105",flightId:2,ancillary:[],wheelChair:!1,infants:1,seat:"4A",status:"infants",mealPreference:1,purchase:[3],specialMeals:[4],passport:!1,address:"xlz",dob:""},{id:6,name:"Roger",pnr:"IND106",flightId:3,ancillary:[],wheelChair:!0,infants:0,seat:"1A",status:"wheelChair",mealPreference:3,purchase:[1],specialMeals:[2,3],passport:!0,address:"",dob:""},{id:7,name:"Sai",pnr:"IND107",flightId:3,ancillary:[],wheelChair:!1,infants:0,seat:"2B",status:"reserved",mealPreference:2,purchase:[1,3],specialMeals:[],passport:!0,address:"tyz",dob:"1995-12-01"},{id:8,name:"Rahul",pnr:"IND108",flightId:3,ancillary:[1],wheelChair:!1,infants:0,seat:"3A",status:"reserved",mealPreference:3,purchase:[],specialMeals:[],passport:!1,address:"pyz",dob:""}],purchases:{1:{id:1,value:"fitbit"},2:{id:2,value:"Smartwatch"},3:{id:3,value:"Bluetooth speaker"},4:{id:4,value:"EarPods"}},ancillaries:[{id:1,value:{1:{id:1,value:"seat-plus"},2:{id:2,value:"Excess Baggage"},3:{id:3,value:"Fast Forward"},4:{id:4,value:"Travel Assistance"}}},{id:2,value:{1:{id:1,value:"seat-plus"},2:{id:2,value:"Excess Baggage"},3:{id:3,value:"Fast Forward"},4:{id:4,value:"Travel Assistance"}}},{id:3,value:{1:{id:1,value:"seat-plus"},2:{id:2,value:"Excess Baggage"},3:{id:3,value:"Fast Forward"},4:{id:4,value:"Travel Assistance"}}},{id:4,value:{1:{id:1,value:"seat-plus"},2:{id:2,value:"Excess Baggage"},3:{id:3,value:"Fast Forward"},4:{id:4,value:"Travel Assistance"}}}],newFlight:{id:null,name:"",departure:"",destination:"",passengers:null,ancillariesId:null,purchases:{},specialMeals:{}},seatMaps:[{id:1,seatmap:[{id:1,number:"1A",status:"reserved",passengerId:1},{id:2,number:"1B",status:"reserved",passengerId:2},{id:3,number:"2A",status:"reserved",passengerId:3},{id:4,number:"2B",status:"available",passengerId:null},{id:5,number:"3A",status:"available",passengerId:null},{id:6,number:"3B",status:"available",passengerId:null},{id:7,number:"4A",status:"available",passengerId:null},{id:8,number:"4B",status:"available",passengerId:null}]},{id:2,seatmap:[{id:1,number:"1A",status:"available",passengerId:null},{id:2,number:"1B",status:"available",passengerId:null},{id:3,number:"2A",status:"reserved",passengerId:4},{id:4,number:"2B",status:"available",passengerId:null},{id:5,number:"3A",status:"available",passengerId:null},{id:6,number:"3B",status:"available",passengerId:null},{id:7,number:"4A",status:"reserved",passengerId:5},{id:8,number:"4B",status:"available",passengerId:null}]},{id:3,seatmap:[{id:1,number:"1A",status:"reserved",passengerId:6},{id:2,number:"1B",status:"available",passengerId:null},{id:3,number:"2A",status:"available",passengerId:null},{id:4,number:"2B",status:"reserved",passengerId:7},{id:5,number:"3A",status:"reserved",passengerId:8},{id:6,number:"3B",status:"available",passengerId:null},{id:7,number:"4A",status:"available",passengerId:null},{id:8,number:"4B",status:"available",passengerId:null}]},{id:4,seatmap:[{id:1,number:"1A",status:"available",passengerId:null},{id:2,number:"1B",status:"available",passengerId:null},{id:3,number:"2A",status:"available",passengerId:null},{id:4,number:"2B",status:"available",passengerId:null},{id:5,number:"3A",status:"available",passengerId:null},{id:6,number:"3B",status:"available",passengerId:null},{id:7,number:"4A",status:"available",passengerId:null},{id:8,number:"4B",status:"available",passengerId:null}]}],newSeatMap:{id:1,seatmap:[{id:1,number:"1A",status:"available",passengerId:null},{id:2,number:"1B",status:"available",passengerId:null},{id:3,number:"2A",status:"available",passengerId:null},{id:4,number:"2B",status:"available",passengerId:null},{id:5,number:"3A",status:"available",passengerId:null},{id:6,number:"3B",status:"available",passengerId:null},{id:7,number:"4A",status:"available",passengerId:null},{id:8,number:"4B",status:"available",passengerId:null}]},newSeat:{id:null,number:"",status:"",passengerId:null}}},77:function(e,a,t){"use strict";var n=t(8),s=t(75),r="https://my-json-server.typicode.com/rajat-agrvm/mock-json-server/flights/";function l(){return function(e){return fetch(r).then(s.b).catch(s.a).then((function(a){e(function(e){return{type:n.f,flights:e}}(a))})).catch((function(e){throw e}))}}function i(e){return function(a,t){return function(e){return fetch(r+(e.id||""),{method:e.id?"PUT":"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(s.b).catch(s.a)}(e).then((function(t){e.id?a(function(e){return{type:n.i,flight:e}}(t)):a(function(e){return{type:n.b,flight:e}}(t))})).catch((function(e){throw e}))}}t.d(a,"a",(function(){return l})),t.d(a,"b",(function(){return i}))},78:function(e,a,t){"use strict";var n=t(0),s=t.n(n);t(79);a.a=function(){return s.a.createElement("div",{className:"loader"},"Loading...")}},79:function(e,a,t){},80:function(e,a,t){"use strict";var n=t(8),s=t(75),r="https://my-json-server.typicode.com/rajat-agrvm/mock-json-server/passengers/";function l(){return function(e){return fetch(r).then(s.b).catch(s.a).then((function(a){e(function(e){return{type:n.g,passengers:e}}(a))})).catch((function(e){throw e}))}}function i(e){return function(a,t){return function(e){return fetch(r+(e.id||""),{method:e.id?"PUT":"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(s.b).catch(s.a)}(e).then((function(t){e.id?a(function(e){return{type:n.k,passenger:e}}(t)):a(function(e){return{type:n.c,passenger:e}}(t))})).catch((function(e){throw e}))}}t.d(a,"a",(function(){return l})),t.d(a,"b",(function(){return i}))},90:function(e,a,t){"use strict";var n=t(8),s=t(75),r="https://my-json-server.typicode.com/rajat-agrvm/mock-json-server/ancillaries/";function l(){return function(e){return fetch(r).then(s.b).catch(s.a).then((function(a){e(function(e){return{type:n.e,ancillaries:e}}(a))})).catch((function(e){throw e}))}}function i(e){return function(a,t){return function(e){return fetch(r+(e.id||""),{method:e.id?"PUT":"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(s.b).catch(s.a)}(e).then((function(t){e.id?a(function(e){return{type:n.h,ancillary:e}}(t)):a(function(e){return{type:n.a,ancillary:e}}(t))})).catch((function(e){throw e}))}}t.d(a,"a",(function(){return l})),t.d(a,"b",(function(){return i}))}}]);
//# sourceMappingURL=7.bundle.js.map